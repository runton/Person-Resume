(function(a,b){if(typeof define==="function"&&define.amd){define(["$"],b)}else{if(typeof exports==="object"){module.exports=b()}else{a.Query=b(window.Zepto||window.jQuery||$)}}})(this,function(b){var a={getQuery:function(d,l,k){var f=new RegExp("(^|&|#)"+d+"=([^&]*)(&|$|#)","i");k=k||window;var e=k.location.href;var m,j,h="";if(l=="#"){m=e.split("#")}else{m=e.split("?")}if(m.length==1){j=""}else{j=m[1]}if(j!=""){gg=j.split(/&|#/);var c=gg.length;str=arguments[0]+"=";for(i=0;i<c;i++){if(gg[i].indexOf(str)==0){h=gg[i].replace(str,"");break}}}return decodeURI(h)},getForm:function(f){var c={},d={};b(f).find("*[name]").each(function(n,k){var j,l=b(k).attr("name"),r=b.trim(b(k).val()),m=[];if(l==""||b(k).hasClass("getvalued")){return}if(b(k).data("type")=="money"){r=r.replace(/\,/gi,"")}if(b(k).attr("type")=="radio"){var p=null;b("input[name='"+l+"']:radio").each(function(){if(b(this).is(":checked")){p=b.trim(b(this).val())}});if(p){r=p}else{r=""}}if(b(k).attr("type")=="checkbox"){var p=[];b("input[name='"+l+"']:checkbox").each(function(){if(b(this).is(":checked")){p.push(b.trim(b(this).val()))}});if(p.length){r=p.join(",")}else{r=""}}if(b(k).attr("listvalue")){if(!c[b(k).attr("listvalue")]){c[b(k).attr("listvalue")]=[];b("input[listvalue='"+b(k).attr("listvalue")+"']").each(function(){if(b(this).val()!=""){var s=b(this).attr("name");var t={};if(b(this).data("type")=="json"){t[s]=JSON.parse(b(this).val())}else{t[s]=b.trim(b(this).val())}if(b(this).attr("paramquest")){var u=JSON.parse(b(this).attr("paramquest"));t=b.extend(t,u)}c[b(k).attr("listvalue")].push(t);b(this).addClass("getvalued")}})}}if(b(k).attr("arrayvalue")){if(!c[b(k).attr("arrayvalue")]){c[b(k).attr("arrayvalue")]=[];b("input[arrayvalue='"+b(k).attr("arrayvalue")+"']").each(function(){if(b(this).val()!=""){var s={};if(b(this).data("type")=="json"){s=JSON.parse(b(this).val())}else{s=b.trim(b(this).val())}if(b(this).attr("paramquest")){var t=JSON.parse(b(this).attr("paramquest"));s=b.extend(s,t)}c[b(k).attr("arrayvalue")].push(s)}})}}if(l==""||b(k).hasClass("getvalued")){return}if(l.match(/\./)){m=l.split(".");j=m[0];if(m.length==3){d[m[1]]=d[m[1]]||{};d[m[1]][m[2]]=r}else{if(b(k).data("type")=="json"){d[m[1]]=JSON.parse(r);if(b(k).attr("paramquest")){var q=JSON.parse(b(k).attr("paramquest"));d[m[1]]=b.extend(d[m[1]],q)}}else{d[m[1]]=r}}if(!c[j]){c[j]=d}else{c[j]=b.extend({},c[j],d)}}else{c[l]=r}});var g={};for(var h in c){var e=c[h];if(typeof e=="object"){g[h]=JSON.stringify(e)}else{g[h]=c[h]}}b(".getvalued").removeClass("getvalued");return g},setHash:function(e){var f="";e=b.extend(this.getHash(),e);var c=[];for(var d in e){if(e[d]!=""){c.push(d+"="+encodeURIComponent(e[d]))}}f+=c.join("&");location.hash=f;return this},getHash:function(f){if(typeof f==="string"){return this.getQuery(f,"#")}else{var j={};var h=location.hash;if(h.length>0){h=h.substr(1);var e=h.split("&");for(var g=0,d=e.length;g<d;g++){var c=e[g].split("=");if(c.length>0){j[c[0]]=decodeURI(c[1])||""}}}return j}}};return a});