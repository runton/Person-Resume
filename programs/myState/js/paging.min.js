(function(a,b){if(typeof define==="function"&&define.amd){define(["$","query"],b)}else{if(typeof exports==="object"){module.exports=b()}else{a.Paging=b(window.Zepto||window.jQuery||$,Query)}}})(this,function(c,b){c.fn.Paging=function(e){var d=[];c(this).each(function(){var f=c.extend({target:c(this)},e);var g=new a();g.init(f);d.push(g)});return d};function a(){var d=Math.random().toString().replace(".","");this.id="Paging_"+d}a.prototype={init:function(d){this.settings=c.extend({callback:null,pagesize:10,current:1,prevTpl:"上一页",nextTpl:"下一页",firstTpl:"首页",lastTpl:"末页",ellipseTpl:"...",toolbar:false,hash:true,pageSizeList:[5,10,15,20]},d);this.target=c(this.settings.target);this.container=c('<div id="'+this.id+'" class="ui-paging-container"/>');this.target.append(this.container);this.render(this.settings);this.format();this.bindEvent()},render:function(d){this.count=d.count||this.settings.count;this.pagesize=d.pagesize||this.settings.pagesize;this.current=d.current||this.settings.current;this.pagecount=Math.ceil(this.count/this.pagesize);this.format()},bindEvent:function(){var d=this;this.container.on("click","li.js-page-action,li.ui-pager",function(f){if(c(this).hasClass("ui-pager-disabled")||c(this).hasClass("focus")){return false}if(c(this).hasClass("js-page-action")){if(c(this).hasClass("js-page-first")){d.current=1}if(c(this).hasClass("js-page-prev")){d.current=Math.max(1,d.current-1)}if(c(this).hasClass("js-page-next")){d.current=Math.min(d.pagecount,d.current+1)}if(c(this).hasClass("js-page-last")){d.current=d.pagecount}}else{if(c(this).data("page")){d.current=parseInt(c(this).data("page"))}}d.go()})},go:function(d){var e=this;this.current=d||this.current;this.current=Math.max(1,e.current);this.current=Math.min(this.current,e.pagecount);this.format();if(this.settings.hash){b.setHash({page:this.current})}this.settings.callback&&this.settings.callback(this.current,this.pagesize,this.pagecount)},changePagesize:function(d){this.render({pagesize:d})},format:function(){var e="<ul>";e+='<li class="js-page-first js-page-action ui-pager" >'+this.settings.firstTpl+"</li>";e+='<li class="js-page-prev js-page-action ui-pager">'+this.settings.prevTpl+"</li>";if(this.pagecount>6){e+='<li data-page="1" class="ui-pager">1</li>';if(this.current<=2){e+='<li data-page="2" class="ui-pager">2</li>';e+='<li data-page="3" class="ui-pager">3</li>';e+='<li class="ui-paging-ellipse">'+this.settings.ellipseTpl+"</li>"}else{if(this.current>2&&this.current<=this.pagecount-2){e+="<li>"+this.settings.ellipseTpl+"</li>";e+='<li data-page="'+(this.current-1)+'" class="ui-pager">'+(this.current-1)+"</li>";e+='<li data-page="'+this.current+'" class="ui-pager">'+this.current+"</li>";e+='<li data-page="'+(this.current+1)+'" class="ui-pager">'+(this.current+1)+"</li>";e+='<li class="ui-paging-ellipse" class="ui-pager">'+this.settings.ellipseTpl+"</li>"}else{e+='<li class="ui-paging-ellipse" >'+this.settings.ellipseTpl+"</li>";for(var d=this.pagecount-2;d<this.pagecount;d++){e+='<li data-page="'+d+'" class="ui-pager">'+d+"</li>"}}}e+='<li data-page="'+this.pagecount+'" class="ui-pager">'+this.pagecount+"</li>"}else{for(var d=1;d<=this.pagecount;d++){e+='<li data-page="'+d+'" class="ui-pager">'+d+"</li>"}}e+='<li class="js-page-next js-page-action ui-pager">'+this.settings.nextTpl+"</li>";e+='<li class="js-page-last js-page-action ui-pager">'+this.settings.lastTpl+"</li>";e+="</ul>";this.container.html(e);if(this.current==1){c(".js-page-prev",this.container).addClass("ui-pager-disabled");c(".js-page-first",this.container).addClass("ui-pager-disabled")}if(this.current==this.pagecount){c(".js-page-next",this.container).addClass("ui-pager-disabled");c(".js-page-last",this.container).addClass("ui-pager-disabled")}this.container.find('li[data-page="'+this.current+'"]').addClass("focus").siblings().removeClass("focus");if(this.settings.toolbar){this.bindToolbar()}},bindToolbar:function(){var j=this;var f=c('<li class="ui-paging-toolbar"><select class="ui-select-pagesize"></select><input type="text" class="ui-paging-count"/><a href="javascript:void(0)">跳转</a></li>');var g=c(".ui-select-pagesize",f);var h="";for(var e=0,d=this.settings.pageSizeList.length;e<d;e++){h+='<option value="'+this.settings.pageSizeList[e]+'">'+this.settings.pageSizeList[e]+"条/页</option>"}g.html(h);g.val(this.pagesize);c("input",f).val(this.current);c("input",f).click(function(){c(this).select()}).keydown(function(k){if(k.keyCode==13){var i=parseInt(c(this).val())||1;j.go(i)}});c("a",f).click(function(){var i=parseInt(c(this).prev().val())||1;j.go(i)});g.change(function(){j.changePagesize(c(this).val())});this.container.children("ul").append(f)}};return a});